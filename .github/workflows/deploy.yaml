name: Deploy trackTeacher front
on:
    push:
        branches:
            - master

jobs:
    deploy:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout
              uses: actions/checkout@v2.3.1
              with:
                  persist-credentials: false

            - name: Install and test ðŸ”§
              env:
                  CI: ""
              run: |
                  npm install
#                  npm run ci

            - name: Build ðŸ”§
              env:
                  CI: ""
                  API_URL: "https://messangerkx.herokuapp.com/"
              run: |
                  npm run build

            - name: Deploy ðŸš€
              uses: kciter/aws-ecr-action@master
              with:
                  access_key_id: ${{ secrets.AWS_ACCESS }}
                  secret_access_key: ${{ secrets.AWS_SECRET }}
                  account_id: ${{ secrets.AWS_ACCOUNT }}
                  repo: messangerclient
                  region: eu-central-1
                  tags: latest, ${{github.sha}}
                  create_repo: true
