name: Deploy messanger front
on:
    push:
        branches:
            - master

jobs:
    deploy:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout
              uses: actions/checkout@v2.3.1
              with:
                  persist-credentials: false

            - name: Install and test ðŸ”§
              env:
                  CI: ""
              run: |
                  npm install
#                  npm run ci

            - name: Build image
              run: docker build -t messanger/client:prod.${{github.sha}} .

            - name: Deploy image ðŸš€
              uses: jwalton/gh-ecr-push@v1
              with:
                  access-key-id: ${{ secrets.AWS_ACCESS }}
                  secret-access-key: ${{ secrets.AWS_SECRET }}
                  region: eu-central-1
                  local-image: messanger/client:prod.${{github.sha}}
                  is-semver: true
                  image: messanger/client
